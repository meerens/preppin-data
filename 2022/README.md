[‚Üê Back to main page](https://github.com/meerens/preppin-data/blob/main/README.md)

| üìÜ        | üóÇ                                        | üßÆ                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              | üß†                                                                                                 | üìí                                                         | üìù                                                                                                                                                                             |
| --------- | ----------------------------------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | -------------------------------------------------------------------------------------------------- | ---------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |
| 2022-WK23 | Salesforce Opportunities                  | [UNPIVOT](https://cloud.google.com/bigquery/docs/reference/standard-sql/query-syntax#unpivot_operator) - [CASE ](https://cloud.google.com/bigquery/docs/reference/standard-sql/conditional_expressions#case_expr)-  [IF](https://cloud.google.com/bigquery/docs/reference/standard-sql/conditional_expressions#if) - [UNION DISTINCT](https://cloud.google.com/bigquery/docs/reference/standard-sql/query-syntax#union)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         | [Challenge](https://preppindata.blogspot.com/2022/06/2022-week-23-pd-x-wow-salesforce.html)        | [Solution Notebook](https://count.co/notebook/ALLYdShxAnd) | Unpivoting a wide table (2 columns to rows), unioning tables without duplicating records, chained if functions                                                                 |
| 2022-WK24 | Longest Flights                           | [TRIM](https://cloud.google.com/bigquery/docs/reference/standard-sql/string_functions#trim) - [SPLIT](https://cloud.google.com/bigquery/docs/reference/standard-sql/string_functions#split) - [REPLACE](https://cloud.google.com/bigquery/docs/reference/standard-sql/string_functions#replace) - [ORDINAL](https://cloud.google.com/bigquery/docs/reference/standard-sql/operators#array_subscript_operator) - [CONCAT](https://cloud.google.com/bigquery/docs/reference/standard-sql/string_functions#concat) - [CAST](https://cloud.google.com/bigquery/docs/reference/standard-sql/conversion_functions#cast) - [PARSE_DATE](https://cloud.google.com/bigquery/docs/reference/standard-sql/date_functions#parse_date) - [DENSE_RANK](https://cloud.google.com/bigquery/docs/reference/standard-sql/numbering_functions#dense_rank)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          | [Challenge](https://preppindata.blogspot.com/2022/06/2022-week-24-longest-flights.html)            | [Solution Notebook](https://count.co/notebook/egsKBXWNQqW) | Complex chained string manipulations (arrays, multiple chained functions), dual join (same table on different columns), parsing a date from a string                           |
| 2022-WK25 | Housing Happy Hotel Guests                | [ARRAY_LENGTH](https://cloud.google.com/bigquery/docs/reference/standard-sql/arrays#finding_lengths) - [SPLIT](https://cloud.google.com/bigquery/docs/reference/standard-sql/string_functions#split) - [CASE](https://cloud.google.com/bigquery/docs/reference/standard-sql/conditional_expressions#case_expr) - [CONTAINS_SUBSTR ](https://cloud.google.com/bigquery/docs/reference/standard-sql/string_functions#contains_substr)- [MAX() OVER (PARTITION BY)](https://cloud.google.com/bigquery/docs/reference/standard-sql/window-function-calls)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | [Challenge](https://preppindata.blogspot.com/2022/06/2022-week-25-housing-happy-hotel-guests.html) | [Solution Notebook](https://count.co/notebook/QLP6USadahs) | Complex filtering in WHERE using CASE & LIKE, window functions (aggregation)                                                                                                   |
| 2022-WK26 | Making Spotify Data Spotless              | [ROUND](https://cloud.google.com/bigquery/docs/reference/standard-sql/mathematical_functions#round) - [EXTRACT](https://cloud.google.com/bigquery/docs/reference/standard-sql/date_functions#extract) - [CAST](https://cloud.google.com/bigquery/docs/reference/standard-sql/conversion_functions#cast) - [PIVOT](https://cloud.google.com/bigquery/docs/reference/standard-sql/query-syntax#pivot_operator) - [ROW_NUMBER](https://cloud.google.com/bigquery/docs/reference/standard-sql/numbering_functions#row_number)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       | [Challenge](https://preppindata.blogspot.com/2022/06/2022-week-26-making-spotify-data.html)        | [Solution Notebook](https://count.co/notebook/QNeQy4t45lN) | Pivoting (rows to columns), window functions (ranking)                                                                                                                         |
| 2022-WK27 | C&BSCo Clean and Aggregate                | [SPLIT](https://cloud.google.com/bigquery/docs/reference/standard-sql/string_functions#split) - [ORDINAL](https://cloud.google.com/bigquery/docs/reference/standard-sql/operators#array_subscript_operator) - [TRIM](https://cloud.google.com/bigquery/docs/reference/standard-sql/string_functions#trim) - [RTRIM](https://cloud.google.com/bigquery/docs/reference/standard-sql/string_functions#rtrim) - [LENGTH](https://cloud.google.com/bigquery/docs/reference/standard-sql/string_functions#length) - [CONTAINS_SUBSTR](https://cloud.google.com/bigquery/docs/reference/standard-sql/string_functions#contains_substr) - [REPLACE](https://cloud.google.com/bigquery/docs/reference/standard-sql/string_functions#replace) - [CAST](https://cloud.google.com/bigquery/docs/reference/standard-sql/conversion_functions#cast)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | [Challenge](https://preppindata.blogspot.com/2022/07/2022-week-27-c-clean-and-aggregate.html)      | [Solution Notebook](https://count.co/notebook/bSXqSaQ9Zdo) | String manipulation by creating an array from a string and accessing specific elements                                                                                         |
| 2022-WK28 | C&BSCo No Sales Today                     | [EXTRACT](https://cloud.google.com/bigquery/docs/reference/standard-sql/date_functions#extract) - [CAST](https://cloud.google.com/bigquery/docs/reference/standard-sql/conversion_functions#cast) - [GENERATE_DATE_ARRAY](https://cloud.google.com/bigquery/docs/reference/standard-sql/array_functions#generate_date_array) - [UNNEST ](https://cloud.google.com/bigquery/docs/reference/standard-sql/query-syntax#unnest_operator)- [FORMAT_DATE](https://cloud.google.com/bigquery/docs/reference/standard-sql/date_functions#format_date)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   | [Challenge](https://preppindata.blogspot.com/2022/07/2022-week-28-c-no-sales-today.html)           | [Solution Notebook](https://count.co/notebook/wMfhkjhzQBp) | Create an array of dates, converting elements in an array to individual rows                                                                                                   |
| 2022-WK29 | C&BSco Meeting Targets?                   | [TRIM](https://cloud.google.com/bigquery/docs/reference/standard-sql/string_functions#trim) - [SPLIT](https://cloud.google.com/bigquery/docs/reference/standard-sql/string_functions#split) - [UNPIVOT](https://cloud.google.com/bigquery/docs/reference/standard-sql/query-syntax#unpivot_operator) - [INITCAP ](https://cloud.google.com/bigquery/docs/reference/standard-sql/string_functions#initcap)- [STRUCT](https://cloud.google.com/spanner/docs/reference/standard-sql/data-types#constructing_a_struct) - [UNNEST](https://cloud.google.com/bigquery/docs/reference/standard-sql/query-syntax#unnest_operator)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       | [Challenge](https://preppindata.blogspot.com/2022/07/2022-week-29-c-meeting-targets.html)          | [Solution Notebook](https://count.co/notebook/Kj16wzIOrPs) | Unpivoting (columns to rows), using proper case                                                                                                                                |
| 2022-WK30 | C&BSCo Actual Sales Values                | [UNION ALL](https://cloud.google.com/bigquery/docs/reference/standard-sql/query-syntax#union) - [ROUND](https://cloud.google.com/bigquery/docs/reference/standard-sql/mathematical_functions#round) - [CAST](https://cloud.google.com/bigquery/docs/reference/standard-sql/conversion_functions#cast)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | [Challenge](https://preppindata.blogspot.com/2022/07/2022-week-30-c-actual-sales-values.html)      | [Solution Notebook](https://count.co/notebook/wTDx086J1yp) | Unioning 2 files and adding a column to identify the file (read: region), simple joins and aggregations                                                                        |
| 2022-WK31 | C&BSCo Preppin' Parameters                | [SPLIT](https://cloud.google.com/bigquery/docs/reference/standard-sql/string_functions#split) - [ORDINAL](https://cloud.google.com/bigquery/docs/reference/standard-sql/operators#array_subscript_operator) - [TRIM](https://cloud.google.com/bigquery/docs/reference/standard-sql/string_functions#trim) - [ROUND ](https://cloud.google.com/bigquery/docs/reference/standard-sql/mathematical_functions#round)- [RANK](https://cloud.google.com/bigquery/docs/reference/standard-sql/numbering_functions#rank)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                | [Challenge](https://preppindata.blogspot.com/2022/08/2022-week-31-c-preppin-parameters.html)       | [Solution Notebook](https://count.co/notebook/ZVkjh4yRKot) | Practicing basics (string manipulations using arrays and ordinal position, aggregations, filtering), TOP N using CTE‚Äôs, rounding before decimal point                          |
| 2022-WK32 | C&BSCo Mortgage Repayments                | [CAST](https://cloud.google.com/bigquery/docs/reference/standard-sql/mathematical_functions#round) - [ROUND](https://cloud.google.com/bigquery/docs/reference/standard-sql/mathematical_functions#round) - [PARSE_DATE](https://cloud.google.com/bigquery/docs/reference/standard-sql/date_functions#parse_date) - [GENERATE_DATE_ARRAY ](https://cloud.google.com/bigquery/docs/reference/standard-sql/array_functions#generate_date_array)- [DATE_ADD](https://cloud.google.com/bigquery/docs/reference/standard-sql/date_functions#date_add) - [GENERATE_ARRAY ](https://cloud.google.com/bigquery/docs/reference/standard-sql/array_functions#generate_array)- [ROW_NUMBER](https://cloud.google.com/bigquery/docs/reference/standard-sql/numbering_functions#row_number) - [CROSS JOIN UNNEST](https://cloud.google.com/bigquery/docs/reference/standard-sql/arrays#flattening_arrays)                                                                                                                                                                                                                                                                                                                                                                                                                                                                     | [Challenge](https://preppindata.blogspot.com/2022/07/2022-week-32-c-mortgage-repayments.html)      | [Solution Notebook](https://count.co/notebook/2pbGJxHFuSq) | Generating arrays (dates, numeric values), flatten arrays while preserving the values of the other columns in the table, adding a timeinterval to a date, creating a row index |
| 2022-WK33 | C&BSCo Next Sale                          | [UNION ALL](https://cloud.google.com/bigquery/docs/reference/standard-sql/query-syntax#set_operators) - [SPLIT](https://cloud.google.com/bigquery/docs/reference/standard-sql/string_functions#split) - [ORDINAL](https://cloud.google.com/bigquery/docs/reference/standard-sql/operators#array_subscript_operator) - [LEAD](https://cloud.google.com/bigquery/docs/reference/standard-sql/navigation_functions#lead)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | [Challenge](https://preppindata.blogspot.com/2022/08/2022-week-33-c-next-sale.html)                | [Solution Notebook](https://count.co/notebook/BHLe4x6IZJN) | Unioning tables (tables don‚Äôt have the same number of columns), importance of the order of operations, determining the next value in bringing it back to same row              |
| 2022-WK34 | C&BSCo Parameters, Parameters, Parameters | [CASE](https://cloud.google.com/bigquery/docs/reference/standard-sql/conditional_expressions#case_expr) - [SPLIT](https://cloud.google.com/bigquery/docs/reference/standard-sql/string_functions#split) - [ORDINAL](https://cloud.google.com/bigquery/docs/reference/standard-sql/operators#array_subscript_operator) - [INITCAP](https://cloud.google.com/bigquery/docs/reference/standard-sql/string_functions#initcap) - [DENSE_RANK](https://cloud.google.com/bigquery/docs/reference/standard-sql/numbering_functions#dense_rank)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          | [Challenge](https://preppindata.blogspot.com/2022/08/2022-week-34-c-parameters-parameters.html)    | [Solution Notebook](https://count.co/notebook/IGnJywbVtfa) | Practising splitting strings using arrays,  ranking records using dense_rank (ranking increments by 1, records in the same subset are ranked the same)                         |
| 2022-WK35 | C&BSCo Summary Stats                      | [EXTRACT](https://cloud.google.com/bigquery/docs/reference/standard-sql/date_functions#extract) - [CAST](https://cloud.google.com/bigquery/docs/reference/standard-sql/conversion_functions#cast) - [CASE](https://cloud.google.com/bigquery/docs/reference/standard-sql/conditional_expressions#case_expr) - [TRIM](https://cloud.google.com/bigquery/docs/reference/standard-sql/string_functions#trim) - [ROUND](https://cloud.google.com/bigquery/docs/reference/standard-sql/mathematical_functions#round) - [SPLIT](https://cloud.google.com/bigquery/docs/reference/standard-sql/string_functions#split) - [ORDINAL](https://cloud.google.com/bigquery/docs/reference/standard-sql/operators#array_subscript_operator) - [INITCAP](https://cloud.google.com/bigquery/docs/reference/standard-sql/string_functions#initcap) - [ROW_NUMBER](https://cloud.google.com/bigquery/docs/reference/standard-sql/numbering_functions#row_number) - [CONCAT](https://cloud.google.com/bigquery/docs/reference/standard-sql/string_functions#concat) - [PIVOT](https://cloud.google.com/bigquery/docs/reference/standard-sql/query-syntax#pivot_operator) - [UNION ALL](https://cloud.google.com/bigquery/docs/reference/standard-sql/query-syntax#union) -  [UNPIVOT](https://cloud.google.com/bigquery/docs/reference/standard-sql/query-syntax#unpivot_operator) | [Challenge](https://preppindata.blogspot.com/2022/08/2022-week-35-c-summary-stats.html)            | [Solution Notebook](https://count.co/notebook/KwCExg1P527) | Combining PIVOT (rows to columns) & UNPIVOT (columns to rows) to reshape a table.                                                                                              |
| 2022-WK36 | Calendar Conundrum                        | [CONCAT](https://cloud.google.com/bigquery/docs/reference/standard-sql/string_functions#concat) - [CAST ](https://cloud.google.com/bigquery/docs/reference/standard-sql/conversion_functions#cast)- [EXTRACT](https://cloud.google.com/bigquery/docs/reference/standard-sql/date_functions#extract) - [GENERATE_DATE_ARRAY](https://cloud.google.com/bigquery/docs/reference/standard-sql/array_functions#generate_date_array) - [PARSE_DATE](https://cloud.google.com/bigquery/docs/reference/standard-sql/date_functions#parse_date) - [CROSS JOIN/UNNEST](https://cloud.google.com/bigquery/docs/reference/standard-sql/arrays#flattening_arrays) -  [CROSS JOIN](https://cloud.google.com/bigquery/docs/reference/standard-sql/query-syntax#cross_join) - [IF](https://cloud.google.com/bigquery/docs/reference/standard-sql/conditional_expressions#if)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    | [Challenge](https://preppindata.blogspot.com/2022/09/2022-week-36-calendar-conundrum.html)         | [Solution Notebook](https://count.co/notebook/5TifbnfV9cz) | Creating an array of dates using various date functions to create a dynamic start and end date for the date array, creating an employee calendar                               |
| 2022-WK37 | Elden Ring Adventure                      | [UNPIVOT](https://cloud.google.com/bigquery/docs/reference/standard-sql/query-syntax#unpivot_operator) - [SPLIT](https://cloud.google.com/bigquery/docs/reference/standard-sql/string_functions#split) - [ORDINAL](https://cloud.google.com/bigquery/docs/reference/standard-sql/operators#array_subscript_operator) - [CAST](https://cloud.google.com/bigquery/docs/reference/standard-sql/conversion_functions#cast) - [REPLACE ](https://cloud.google.com/bigquery/docs/reference/standard-sql/string_functions#replace)- [DENSE_RANK](https://cloud.google.com/bigquery/docs/reference/standard-sql/numbering_functions#dense_rank) - [CASE](https://cloud.google.com/bigquery/docs/reference/standard-sql/conditional_expressions#case)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    | [Challenge](https://preppindata.blogspot.com/2022/09/2022-week-37-elden-ring-adventure.html)       | [Solution Notebook](https://count.co/notebook/VoqdMIPQ90q) | Practising cleaning up strings and unpivot (flip columns to rows), conditional aggregates (wrapping case statements in an aggregation)                                         |

